{"version":3,"file":"/packages/app-item.js","sources":["app-item/item_common.js","app-item/item_client.js"],"names":[],"mappings":";;;;;;;;AAAA,8B;AACA,4C;AACA,2B;AACA,iB;AACA,6C;AACA,gB;AACA,uB;AACA,mD;AACA,G;;AAEA,e;AACA,E;AACA,G;;;;;;;;;;;;;;;;;;;ACZA,yB;AACA,oB;AACA,6C;AACA,e;AACA,E;AACA,E;AACA,8B;AACA,iC;AACA,+B;AACA,8D;AACA,G;AACA,wC;AACA,4C;AACA,6C;AACA,sB;AACA,gD;AACA,sC;AACA,G;AACA,0C;AACA,oC;AACA,0D;AACA,mB;AACA,a;AACA,6C;AACA,W;AACA,I;AACA,+C;AACA,K;AACA,G;AACA,sB;AACA,kE;AACA,G;AACA,wC;AACA,4C;AACA,sC;AACA,kB;AACA,G;AACA,wC;AACA,2C;AACA,uB;AACA,S;AACA,iB;AACA,I;AACA,kB;;AAEA,kB;AACA,G;AACA,wB;AACA,U;AACA,sB;AACA,yC;AACA,I;AACA,I;AACA,E;AACA,G;;AAEA,2B;AACA,6B;AACA,G","sourcesContent":["App.component('item').expose({\n\tcollection: new Meteor.Collection('items'),\n\tpathToRoot: function(id) {\n\t\tvar items = [];\n\t\tvar item = App.item.collection.findOne(id);\n\t\twhile (item) {\n\t\t\titems.unshift(item);\n\t\t\titem = App.item.collection.findOne(item.parent);\n\t\t}\n\n\t\treturn items;\n\t}\n});\n","var dummySubscription = {\n\tready: function() {\n\t\tconsole.log('querying dummy subscription');\n\t\treturn false;\n\t}\n};\nApp.component('item').expose({\n\tsubscription: dummySubscription,\n\tinitSubscription: function() {\n\t\tApp.item.subscription = Meteor.subscribe('items', 'master');\n\t},\n\tsave: function(itemData, defaultType) {\n\t\tvar routeParams = Router.current().params;\n\t\tvar type = routeParams.type || defaultType;\n\t\tvar dataFields = [];\n\t\tif (App.data[type] && App.data[type].fields) {\n\t\t\tdataFields = App.data[type].fields;\n\t\t}\n\t\titemData = _.pick(itemData, dataFields);\n\t\titemData.parent = routeParams._id;\n\t\tMeteor.call('item.save', type, itemData, function(err) {\n\t\t\tApp.menu.show();\n\t\t\tif (err) {\n\t\t\t\tAlerts.add(err.message || err, 'danger');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tAlerts.add('Successfully saved', 'success');\n\t\t});\n\t},\n\tforPath: function() {\n\t\treturn App.item.collection.findOne(Router.current().params._id);\n\t},\n\tchildrenForPath: function(cond, opts) {\n\t\treturn App.item.collection.find(_.extend({\n\t\t\tparent: Router.current().params._id\n\t\t}, cond), opts);\n\t},\n\tsiblings: function(item, findOptions) {\n\t\tvar siblings = App.item.collection.find({\n\t\t\tparent: item.parent,\n\t\t\t_id: {\n\t\t\t\t$ne: item._id\n\t\t\t}\n\t\t}, findOptions);\n\n\t\treturn siblings;\n\t},\n\tsubscribe: function() {\n\t\treturn {\n\t\t\tready: function() {\n\t\t\t\treturn App.item.subscription.ready();\n\t\t\t}\n\t\t};\n\t}\n});\n\nMeteor.startup(function() {\n\tApp.item.initSubscription();\n});\n"]}